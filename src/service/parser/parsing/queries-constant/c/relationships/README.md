# C语言关系查询规则说明
本文档总结了在C语言代码解析中使用的各种关系查询规则，这些规则基于Tree-Sitter查询模式，用于识别和分析代码中的不同类型的语义关系。
## 1. 注解关系 (Annotation Relationships) - annotation.ts
识别代码中的各种注解模式：
- 函数属性注解：识别应用于函数的C11属性说明符
- 类型注解：识别应用于类型定义的注解
- 变量注解：识别应用于变量声明的注解
- 结构体字段注解：识别应用于结构体字段的注解
## 2. 调用关系 (Call Relationships) - call.ts
识别代码中的函数调用模式：
- 基本函数调用：识别函数间的调用关系
- 函数指针调用：识别通过函数指针进行的调用
- 结构体方法调用：识别面向对象风格的方法调用
- 递归调用：识别函数的递归调用
- 链式调用：识别链式的函数调用
- 条件调用：识别在条件语句中的特殊调用
- 回调函数调用：识别回调函数的使用
- 宏函数调用：识别宏函数的调用
## 3. 并发关系 (Concurrency Relationships) - concurrency.ts
识别与并发编程相关的模式：
- 线程管理：线程创建、等待、分离、退出、获取ID等操作
- 互斥锁操作：互斥锁的创建和各种操作（加锁、解锁、销毁等）
- 条件变量操作：条件变量的等待、通知、销毁等操作
- 读写锁操作：读写锁的各种操作
- 信号量操作：信号量的等待、通知、销毁等操作
## 4. 控制流关系 (Control Flow Relationships) - control-flow.ts
识别程序中的控制流结构：
- 条件语句：if、if-else、嵌套if、else-if语句
- 开关语句：switch语句和case分支
- 循环语句：while、do-while、for循环
- 跳转语句：break、continue、goto语句
- 标签语句：标签定义和使用
- 返回语句：return语句
- 条件表达式：三元运算符
- 逻辑运算：逻辑与、或运算符
- 逗号表达式：逗号分隔的表达式序列
## 5. 创建关系 (Creation Relationships) - creation.ts
识别对象和资源的创建模式：
- 内存分配：malloc、calloc、realloc、alloca等内存分配函数
- 文件操作：文件的创建、打开、关闭、读取、写入
- 条件变量创建：条件变量相关操作
- 信号量创建：信号量相关操作
- 套接字创建：网络套接字相关操作
## 6. 数据流关系 (Data Flow Relationships) - data-flow.ts
追踪变量间的数据传递：
- 赋值操作：基本赋值和复合赋值
- 初始化：变量初始化赋值
- 增减量操作：++和--运算符
- 函数调用：参数传递过程中的数据流
- 返回值：函数返回值的数据流
- 指针操作：指针相关的数据操作
- 类型转换：显式类型转换
- 条件表达式：条件运算符中的数据流
- 内存操作：内存操作函数中的数据流
- 链式访问：结构体成员的链式访问
- 宏调用：宏展开中的数据流
- sizeof表达式：sizeof操作中的数据流
## 7. 依赖关系 (Dependency Relationships) - dependency.ts
识别代码模块间的依赖：
- 头文件包含：本地和系统头文件的包含关系
- 宏定义：宏定义和宏函数的依赖
- 条件编译：ifdef、ifndef、elif等条件编译指令
- 类型引用：结构体、枚举、联合体等类型的引用
- 函数声明：外部函数声明的依赖
- 存储类说明符：extern和static变量的依赖
## 8. 继承关系 (Inheritance Relationships) - inheritance.ts
识别C语言中模拟的继承模式：
- 结构体嵌套：通过结构体嵌套实现的继承
- 结构体组合：结构体间的组合关系
- 函数指针接口：通过函数指针实现的接口
- 前向声明：结构体的前向声明关系
- 联合体嵌套：联合体内的嵌套关系
- 枚举继承：枚举类型的层次关系
- 类型别名：typedef定义的类型别名关系
- 多态实现：通过函数指针数组实现的多态
- 虚函数表：结构体中包含的函数指针表
- 回调函数：回调函数接口的实现
- 指针继承：通过指针实现的继承关系
- 成员访问：嵌套结构体成员的访问关系
## 9. 生命周期关系 (Lifecycle Relationships) - lifecycle.ts
识别资源的生命周期管理：
- 内存管理：内存的释放和重新分配
- 资源管理：资源的构造、析构和清理函数
- 作用域管理：局部变量、全局变量、静态变量、参数的作用域
- 变量生命周期：不同类型变量的生命周期管理
## 10. 引用关系 (Reference Relationships) - reference.ts
识别代码中的引用模式：
- 结构体字段引用：对结构体成员的访问
- 数组元素引用：对数组元素的访问
- 指针解引用：通过指针访问数据
- 函数参数引用：函数参数的使用
- 赋值表达式引用：赋值操作中的变量引用
## 11. 语义关系 (Semantic Relationships) - semantic.ts
识别高级语义模式：
- 错误处理：错误返回和错误检查模式
- 资源管理：资源的初始化和管理模式
- 清理模式：资源清理函数的模式
- 回调机制：回调函数的赋值、初始化和类型定义模式
这些查询规则共同构成了对C语言代码进行全面语义分析的基础，能够帮助理解代码结构、识别设计模式、检测潜在问题，并支持代码重构和优化等工作。