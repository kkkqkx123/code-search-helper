{"cells":[{"code":"#include <atomic>\r\n#include <thread>\r\n#include <iostream>\r\n\r\nstd::atomic<int> data(0);\r\nstd::atomic<bool> ready(false);\r\n\r\nvoid writer() {\r\n    data.store(42, std::memory_order_relaxed);\r\n    ready.store(true, std::memory_order_release);\r\n}\r\n\r\nvoid reader() {\r\n    while (!ready.load(std::memory_order_acquire)) {\r\n        // 等待\r\n    }\r\n    std::cout << \"Data: \" << data.load(std::memory_order_relaxed) << std::endl;\r\n}\r\n\r\nint main() {\r\n    std::thread t1(writer);\r\n    std::thread t2(reader);\r\n    \r\n    t1.join();\r\n    t2.join();\r\n    \r\n    return 0;\r\n}","language":"cpp","kind":"code"},{"code":"(call_expression\r\n  function: (field_expression\r\n    (identifier) @atomic.variable\r\n    (field_identifier) @atomic.method)\r\n  arguments: (argument_list\r\n    (identifier) @memory.order))\r\n  (#match? @memory.order \"^(memory_order_relaxed|memory_order_acquire|memory_order_release|memory_order_acq_rel|memory_order_seq_cst)$\") @concurrency.relationship.memory.order","language":"scm","kind":"code"}]}