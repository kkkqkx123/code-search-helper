{"cells":[{"code":"class ProducerConsumerQueue {\r\nprivate:\r\n    std::queue<T> queue;\r\n    std::mutex mtx;\r\n    std::condition_variable cv;\r\n    \r\npublic:\r\n    void push(const T& item) {\r\n        std::lock_guard<std::mutex> lock(mtx);\r\n        queue.push(item);\r\n        cv.notify_one();\r\n    }\r\n    \r\n    T pop() {\r\n        std::unique_lock<std::mutex> lock(mtx);\r\n        cv.wait(lock, [this]{ return !queue.empty(); });\r\n        T item = queue.front();\r\n        queue.pop();\r\n        return item;\r\n    }\r\n};\r\n","language":"cpp","kind":"code"},{"code":";; 最简模式：识别包含 queue + mutex + condition_variable 的类\r\n(class_specifier\r\n  \r\n  \r\n  (field_declaration_list\r\n    ;; 匹配 std::queue<T>\r\n    (field_declaration\r\n      type: (qualified_identifier\r\n        name: (template_type\r\n          name: (type_identifier) @queue_type)))\r\n    \r\n    ;; 匹配 std::mutex\r\n    (field_declaration\r\n      type: (qualified_identifier\r\n        name: (type_identifier) @mutex_type))\r\n    \r\n    ;; 匹配 std::condition_variable\r\n    (field_declaration\r\n      type: (qualified_identifier\r\n        name: (type_identifier) @cv_type))\r\n  )\r\n  \r\n  ;; 验证类型名称\r\n  (#eq? @queue_type \"queue\")\r\n  (#eq? @mutex_type \"mutex\")\r\n  (#eq? @cv_type \"condition_variable\")\r\n)@producer_consumer_queue","language":"scm","kind":"code"}]}