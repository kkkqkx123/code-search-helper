{"cells":[{"code":"#include <vector>\r\n#include <thread>\r\n#include <queue>\r\n#include <mutex>\r\n#include <functional>\r\n#include <iostream>\r\n\r\nclass ThreadPool {\r\nprivate:\r\n    std::vector<std::thread> workers;\r\n    std::queue<std::function<void()>> tasks;\r\n    std::mutex queueMutex;\r\n    \r\npublic:\r\n    ThreadPool(size_t threads) {\r\n        for (size_t i = 0; i < threads; ++i) {\r\n            workers.emplace_back([this] {\r\n                while (true) {\r\n                    std::function<void()> task;\r\n                    {\r\n                        std::unique_lock<std::mutex> lock(queueMutex);\r\n                        if (tasks.empty()) {\r\n                            break;\r\n                        }\r\n                        task = tasks.front();\r\n                        tasks.pop();\r\n                    }\r\n                    task();\r\n                }\r\n            });\r\n        }\r\n    }\r\n    \r\n    ~ThreadPool() {\r\n        for (std::thread &worker : workers) {\r\n            worker.join();\r\n        }\r\n    }\r\n    \r\n    void enqueue(std::function<void()> task) {\r\n        {\r\n            std::unique_lock<std::mutex> lock(queueMutex);\r\n            tasks.push(task);\r\n        }\r\n    }\r\n};\r\n\r\nint main() {\r\n    ThreadPool pool(4);\r\n    \r\n    for (int i = 0; i < 8; ++i) {\r\n        pool.enqueue([i] {\r\n            std::cout << \"Task \" << i << \" executed\" << std::endl;\r\n        });\r\n    }\r\n    \r\n    return 0;\r\n}","language":"cpp","kind":"code"},{"code":"(class_specifier\r\n  name: (type_identifier) @thread.pool.class\r\n  body: (field_declaration_list\r\n    (field_declaration\r\n      declarator: (field_declarator\r\n        declarator: (field_identifier) @workers.field))\r\n    (field_declaration\r\n      declarator: (field_declarator\r\n        declarator: (field_identifier) @tasks.field))\r\n    (field_declaration\r\n      declarator: (field_declarator\r\n        declarator: (field_identifier) @queue.mutex)))) @concurrency.relationship.thread.pool","language":"scm","kind":"code"}]}