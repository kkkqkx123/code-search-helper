{"version":3,"file":"Connection.js","names":["_lodash","_interopRequireDefault","require","_thrift","_events","_GraphService","_parser","_NebulaError","obj","__esModule","default","Connection","EventEmitter","constructor","connectionOption","isReady","isBusy","_","defaults","bufferSize","poolSize","connection","thrift","createConnection","host","port","max_attempts","Number","MAX_SAFE_INTEGER","retry_max_delay","transport","TFramedTransport","client","createClient","GraphService","on","err","_this$_events","error","emit","sender","prepare","delay","attempt","retryInfo","authenticate","userName","password","then","response","error_code","NebulaError","error_msg","sessionId","session_id","Promise","resolve","reject","run","command","space","returnOriginalData","catch","_this$_events2","self","setTimeout","bind","close","connected","signout","end","ping","timeout","timer","execute","clearTimeout","task","start","Date","now","Buffer","from","_response$metrics","executingTimer","metrics","traverse","elapsed","parser","connectionId","finally","getConnectionInfo","exports","module"],"sources":["Connection.ts"],"sourcesContent":[null],"mappings":"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"}